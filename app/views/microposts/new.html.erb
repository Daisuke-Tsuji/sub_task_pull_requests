<% provide(:title,"写真投稿") %>
<div class="d-flex justify-content-center">
  <%= form_with model: @micropost do |f| %>

    <div class="field">
      <%= f.label :投稿写真 %><br />
      <%= f.file_field :image,
                        id: "micropost_img",
                        class: "image",
                        accept: "image/jpeg,image/png" %>
    </div>

    <% if @micropost.image.present? %>
      <div class="micropost_new_preview_size">
        <%= image_tag @micropost, id: :img_prev, class: "micropost_new_size" %>
      </div>
    <% else %>
      <div class="micropost_new_preview_size">
        <img src="/assets/micropost.jpg"
             id="img_prev"
             class="micropost_new_size"
             alt = "#" %>
      </div>
    <% end %>

    <script type="text/javascript">
      $(function() {
        function readURL(input) {
            if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
        $('#img_prev').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
            }
        }
        $("#micropost_img").change(function(){
            readURL(this);
        });
      });
    </script>

    <div class="field">
      <%= f.label :コメント %><br />
      <%= f.text_area :comment %>
    </div>

    <div class="actions">
      <%= f.submit "投稿"%>
    </div>

  <% end %>
</div>
